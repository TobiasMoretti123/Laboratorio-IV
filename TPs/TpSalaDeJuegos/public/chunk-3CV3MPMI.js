import{a as J,c as K,d as Q,e as M}from"./chunk-S5UJMYJ3.js";import{$ as z,U as A,ca as L,ea as q,ga as G}from"./chunk-QRO6ZU5W.js";import{t as W,u as H}from"./chunk-XHZBIIPB.js";import{f as V}from"./chunk-AKS2IQM2.js";import{k as $,l as B,n as U,o as N,p as R}from"./chunk-VA7YLXIX.js";import{Fb as I,Gb as m,Hb as x,Jb as _,Kb as E,Lb as w,Mb as k,Ob as D,Pa as c,Pb as u,Qa as p,Qb as F,Rb as C,Sb as T,ba as b,eb as g,ga as y,gb as h,lb as a,ma as O,mb as r,ob as P,pb as S,wb as v,x as j,yb as d}from"./chunk-YPGK2BPN.js";var X=(()=>{let e=class e{constructor(i){this.firestore=i,this.mensajes$=null,this.nuevoMensaje=""}initChat(){let i=M(this.firestore,"messages"),n=K(i).pipe(j(o=>o.map(l=>({usuario:l.usuario,mensaje:l.mensaje,fecha:l.fecha.toDate()}))));this.mensajes$=n}enviarMensaje(i,n){let o=M(this.firestore,"messages");Q(o,{fecha:new Date,usuario:i,mensaje:n})}};e.\u0275fac=function(n){return new(n||e)(y(J))},e.\u0275prov=b({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ee(t,e){if(t&1&&(P(0),a(1,"div",13)(2,"div",14),m(3),u(4,"date"),r(),a(5,"div",15),m(6),r()(),S()),t&2){let s=d().$implicit;c(3),_("",s.usuario," ",C(4,3,s.fecha,"short"),""),c(3),x(s.mensaje)}}function te(t,e){if(t&1&&(a(0,"div",16)(1,"div",14),m(2),u(3,"date"),r(),a(4,"div",17),m(5),r()()),t&2){let s=d().$implicit;c(2),_("",C(3,3,s.fecha,"short")," ",s.usuario,""),c(3),x(s.mensaje)}}function ne(t,e){if(t&1&&(a(0,"div"),g(1,ee,7,6,"ng-container",12)(2,te,6,6,"ng-template",null,0,T),r()),t&2){let s=e.$implicit,i=I(3),n=d();c(),h("ngIf",s.usuario===(n.auth.currentUser==null?null:n.auth.currentUser.email))("ngIfElse",i)}}var he=(()=>{let e=class e{constructor(i,n,o){this.chatService=i,this.auth=n,this.router=o,this.mensajes$=null,this.nuevoMensaje=""}ngOnInit(){this.chatService.initChat(),this.mensajes$=this.chatService.mensajes$}enviarMensaje(){this.nuevoMensaje.trim()!==""&&(this.chatService.enviarMensaje(this.auth.currentUser?.email,this.nuevoMensaje),this.nuevoMensaje="")}Volver(){this.RuteoHome()}RuteoHome(){this.router.navigate(["/home"])}};e.\u0275fac=function(n){return new(n||e)(p(X),p(A),p(V))},e.\u0275cmp=O({type:e,selectors:[["app-chat"]],standalone:!0,features:[D],decls:14,vars:4,consts:[["otherUser",""],[1,"contenedor"],[1,"row","justify-content-center"],[1,"col-md-6","border","p-4"],[1,"chat-box"],[1,"messages"],[4,"ngFor","ngForOf"],[1,"input-area"],["matInput","","type","text","placeholder","Escribe un mensaje...",3,"ngModelChange","ngModel"],["mat-raised-button","","color","warn",3,"click"],[1,"volver"],["mat-raised-button","","color","primary",3,"click"],[4,"ngIf","ngIfElse"],[1,"sent-message"],[1,"metadata"],[1,"message-sent"],[1,"received-message"],[1,"message-received"]],template:function(n,o){n&1&&(a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),g(5,ne,4,2,"div",6),u(6,"async"),r()(),a(7,"div",7)(8,"input",8),k("ngModelChange",function(f){return w(o.nuevoMensaje,f)||(o.nuevoMensaje=f),f}),r(),a(9,"button",9),v("click",function(){return o.enviarMensaje()}),m(10,"Enviar"),r()(),a(11,"div",10)(12,"button",11),v("click",function(){return o.Volver()}),m(13,"Volver"),r()()()()()),n&2&&(c(5),h("ngForOf",F(6,2,o.chatService.mensajes$)),c(3),E("ngModel",o.nuevoMensaje))},dependencies:[R,$,B,U,N,G,z,L,q,H,W],styles:[".contenedor[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:90vh}.border[_ngcontent-%COMP%]{border:4px solid #615305;border-radius:10px}.chat-box[_ngcontent-%COMP%]{width:600px;height:700px;border:4px solid #615305;overflow-y:auto}.metadata[_ngcontent-%COMP%]{font-size:12px;color:#666;margin-top:4px}.sent-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;margin-bottom:10px}.received-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin-bottom:10px}.message-sent[_ngcontent-%COMP%]{background-color:#dcf8c6;padding:8px 12px;border-radius:8px}.message-received[_ngcontent-%COMP%]{background-color:#eaeaea;padding:8px 12px;border-radius:8px}.input-area[_ngcontent-%COMP%]{padding:10px;display:flex;align-items:center}.input-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:5px}.input-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;margin-left:10px}.volver[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin-top:10px;margin-bottom:10px}"]});let t=e;return t})();export{he as ChatComponent};
