import{a as v,b as K,d as X,e as Y,f as b,h as Z,i as ee}from"./chunk-TDYGSUN5.js";import{a as L,d as Q,f as $,h as G}from"./chunk-G2BCKOD2.js";import{$ as q,V,ka as H,la as W,ma as J}from"./chunk-5LNGFYFJ.js";import{g as N}from"./chunk-TERAQOSY.js";import"./chunk-WXI33M2S.js";import{k as w,l as z,p as D,q as R,r as A}from"./chunk-MZ2EVUCB.js";import{Fb as I,Gb as c,Hb as x,Jb as C,Kb as P,Lb as k,Mb as T,Ob as U,Pa as m,Pb as h,Qa as u,Qb as B,Rb as M,Sb as F,ba as j,eb as f,ga as S,gb as g,lb as a,ma as y,mb as r,ob as O,pb as E,wb as d,yb as p}from"./chunk-EPM2LCS5.js";var te=(()=>{let n=class n{constructor(e){this.firestore=e,this.mensajes=null,this.nuevoMensaje=""}IniciarChat(){let e=b(this.firestore,"messages"),i=ee(e,Z("fecha","desc"));this.mensajes=X(i)}EnviarMensaje(e,i){let o=b(this.firestore,"messages");Y(o,{usuario:e,mensaje:i,fecha:v.now()}).then(()=>console.log("Mensaje enviado correctamente")).catch(l=>console.error("Error al enviar el mensaje:",l))}};n.\u0275fac=function(i){return new(i||n)(S(K))},n.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();function oe(t,n){if(t&1&&(a(0,"div",12),c(1),r()),t&2){let s=p();m(),x(s.auth.currentUser==null?null:s.auth.currentUser.email)}}function re(t,n){if(t&1&&(O(0),a(1,"div",14)(2,"div",15),c(3),h(4,"date"),r(),a(5,"div",16),c(6),r()(),E()),t&2){let s=p().$implicit,e=p();m(3),C("",s.usuario," ",M(4,3,e.ConvertirFecha(s.fecha),"short"),""),m(3),x(s.mensaje)}}function ae(t,n){if(t&1&&(a(0,"div",17)(1,"div",15),c(2),h(3,"date"),r(),a(4,"div",18),c(5),r()()),t&2){let s=p().$implicit,e=p();m(2),C("",s.usuario," ",M(3,3,e.ConvertirFecha(s.fecha),"short"),""),m(3),x(s.mensaje)}}function se(t,n){if(t&1&&(a(0,"div"),f(1,re,7,6,"ng-container",13)(2,ae,6,6,"ng-template",null,0,F),r()),t&2){let s=n.$implicit,e=I(3),i=p();m(),g("ngIf",s.usuario===(i.auth.currentUser==null?null:i.auth.currentUser.email))("ngIfElse",e)}}var ye=(()=>{let n=class n{constructor(e,i,o,l){this.chatService=e,this.auth=i,this.router=o,this.snackBar=l,this.mostrarUsuario=!1,this.mensajes=[],this.nuevoMensaje=""}ngOnInit(){this.chatService.IniciarChat(),this.chatService.mensajes?.subscribe(e=>{this.mensajes=e})}CerrarSession(){q(this.auth),this.AbrirSnackBar("Se a cerrado la sesion"),this.RuteoHome()}AbrirSnackBar(e){this.snackBar.open(e,"Cerrar",{duration:2e3})}EnviarMensaje(){this.nuevoMensaje.trim()!==""&&(this.chatService.EnviarMensaje(this.auth.currentUser?.email,this.nuevoMensaje),this.nuevoMensaje="",console.log(this.nuevoMensaje))}Volver(){this.RuteoHome()}RuteoHome(){this.router.navigate(["/home"])}ConvertirFecha(e){return e instanceof v?e.toDate():e}MostrarUsuario(){this.mostrarUsuario=!0}OcultarUsuario(){this.mostrarUsuario=!1}SobreMi(){this.router.navigate(["/quien-soy"])}};n.\u0275fac=function(i){return new(i||n)(u(te),u(V),u(N),u(J))},n.\u0275cmp=y({type:n,selectors:[["app-chat"]],standalone:!0,features:[U],decls:19,vars:5,consts:[["otherUser",""],[1,"button-grid"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","warn",3,"click"],[1,"material-icons",3,"mouseover","mouseleave"],["class","tooltip",4,"ngIf"],[1,"contenedor"],[1,"chat-box"],[1,"messages"],[4,"ngFor","ngForOf"],[1,"input-area"],["matInput","","type","text","placeholder","Escribe un mensaje...",3,"ngModelChange","ngModel"],[1,"tooltip"],[4,"ngIf","ngIfElse"],[1,"sent-message"],[1,"metadata"],[1,"message-sent"],[1,"received-message"],[1,"message-received"]],template:function(i,o){i&1&&(a(0,"div",1)(1,"button",2),d("click",function(){return o.Volver()}),c(2,"Volver"),r(),a(3,"button",2),d("click",function(){return o.SobreMi()}),c(4,"Sobre M\xED"),r(),a(5,"button",3),d("click",function(){return o.CerrarSession()}),c(6,"Cerrar Sesi\xF3n"),r(),a(7,"i",4),d("mouseover",function(){return o.MostrarUsuario()})("mouseleave",function(){return o.OcultarUsuario()}),c(8,"account_circle"),r(),f(9,oe,2,1,"div",5),r(),a(10,"div",6)(11,"div",7)(12,"div",8),f(13,se,4,2,"div",9),h(14,"async"),r()(),a(15,"div",10)(16,"input",11),T("ngModelChange",function(_){return k(o.nuevoMensaje,_)||(o.nuevoMensaje=_),_}),r(),a(17,"button",3),d("click",function(){return o.EnviarMensaje()}),c(18,"Enviar"),r()()()),i&2&&(m(9),g("ngIf",o.mostrarUsuario),m(4),g("ngForOf",B(14,3,o.chatService.mensajes)),m(3),P("ngModel",o.nuevoMensaje))},dependencies:[A,w,z,D,R,G,L,Q,$,W,H],styles:['.button-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;background-image:url("./media/grid-TFSRBOBQ.png");padding:10px;display:flex;justify-content:flex-end}.button-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;margin-bottom:10px;padding:20px 30px;font-size:20px}.content[_ngcontent-%COMP%]{padding-top:50px}.material-icons[_ngcontent-%COMP%]{margin-left:10px;margin-top:2px;font-size:40px}.contenedor[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#ffffff80;padding:20px;border-radius:10px;text-align:center;margin-top:30px}.chat-box[_ngcontent-%COMP%]{width:450px;height:650px;border:4px solid #000000;border-radius:20px;overflow-y:auto;margin-left:20px}.metadata[_ngcontent-%COMP%]{font-size:12px;color:#000;margin-top:4px;font-size:18px}.sent-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;margin-bottom:10px;font-size:20px;margin-right:20px}.received-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin-bottom:10px;font-size:20px;margin-left:20px}.message-sent[_ngcontent-%COMP%]{background-color:#dcf8c6;padding:8px 12px;border-radius:8px}.message-received[_ngcontent-%COMP%]{background-color:#eaeaea;padding:8px 12px;border-radius:8px}.input-area[_ngcontent-%COMP%]{padding:20px 30px;display:flex;align-items:center}.input-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:20px 30px;font-size:20px}.input-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:30px;margin-left:10px;font-size:20px}.volver[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin-top:10px;margin-bottom:10px;padding:20px 30px;font-size:20px}.tooltip[_ngcontent-%COMP%]{position:absolute;background-color:#000c;color:#fff;padding:5px;border-radius:3px;z-index:9999}']});let t=n;return t})();export{ye as ChatComponent};
